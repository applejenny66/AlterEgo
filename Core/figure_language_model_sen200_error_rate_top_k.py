import numpy as np
import matplotlib
matplotlib.use('TkAgg')
import matplotlib.pyplot as plt

errors = [0.9638888597488403, 0.9752222100893656, 0.9534444252649943, 0.9559999823570251, 0.9670000155766805, 0.9636666536331177, 0.9521110932032267, 0.951111114025116, 0.9455555478731791, 0.9562222202618916, 0.9397777676582336, 0.932888925075531, 0.9323333263397217, 0.9146666526794434, 0.8872222145398457, 0.9140000184377034, 0.8587777932484945, 0.8735555410385132, 0.8364444375038147, 0.7430000146230061, 0.6770000100135803, 0.6107777833938599, 0.5592222293217977, 0.4747777779897054, 0.4426666756470998, 0.38211111227671307, 0.36122223138809206, 0.3118889053662618, 0.2950000027815501, 0.2692222197850545, 0.25366668701171874, 0.22122222781181336, 0.22133334080378214, 0.22388889292875927, 0.17477777500947317, 0.19877777894337972, 0.1924444486697515, 0.17522223095099132, 0.17622222205003102, 0.18788889249165852, 0.19200000564257305, 0.16455555955568948, 0.19100000460942587, 0.1818888892730077, 0.18244444827238718, 0.17522222598393758, 0.1792222221692403, 0.1685555597146352, 0.17466667195161184, 0.1755555550257365, 0.1753333330154419, 0.1547777811686198, 0.18866667250792185, 0.15311111509799957, 0.16933333973089854, 0.16355555951595308, 0.18355556229750317, 0.15677777926127115, 0.20677778522173565, 0.16300000349680582]
error_top_ks_orig = [[0.9638888716697693, 0.9752221981684367, 0.9534444252649943, 0.9559999903043112, 0.9670000235239665, 0.9636666655540467, 0.9521110812822978, 0.951111110051473, 0.9455555478731791, 0.9562221725781759, 0.9397777676582336, 0.9328888654708862, 0.9323333263397217, 0.9146666328112284, 0.8872222185134888, 0.9139999707539876, 0.8587777495384217, 0.8735555489857991, 0.8364444375038147, 0.7430000225702922, 0.6770000179608663, 0.6107777953147888, 0.5592222293217977, 0.47477776805559796, 0.44266666769981383, 0.382111120223999, 0.36122222741444904, 0.3118888854980469, 0.2950000107288361, 0.269222229719162, 0.25366668502489725, 0.22122222383817036, 0.22133333683013917, 0.22388889292875927, 0.17477778096993765, 0.19877777695655824, 0.1924444486697515, 0.1752222289641698, 0.17622222205003102, 0.18788889646530152, 0.1920000066359838, 0.16455555558204651, 0.19099999765555065, 0.1818888912598292, 0.1824444502592087, 0.17522222797075906, 0.1792222261428833, 0.16855556070804595, 0.17466666996479036, 0.1755555550257365, 0.17533333003520965, 0.154777788122495, 0.1886666715145111, 0.15311111509799957, 0.16933333774407705, 0.1635555585225423, 0.1835555613040924, 0.15677778124809266, 0.20677778323491414, 0.16300001045068105], [0.9379999995231628, 0.9314444184303283, 0.911555536588033, 0.9307777523994446, 0.923888874053955, 0.9127777775128683, 0.90855553150177, 0.9229999979337057, 0.9046666781107585, 0.9272221763928731, 0.8997777700424194, 0.8991111477216085, 0.9032222191492717, 0.8837777694066365, 0.8476666649182637, 0.863777760664622, 0.8086666703224182, 0.8192222515741984, 0.7946666558583577, 0.6778889179229737, 0.6186666369438172, 0.5312222361564636, 0.5043333450953166, 0.4146666705608368, 0.3706666688124339, 0.3151111165682475, 0.2835555672645569, 0.24044445057710012, 0.2328889012336731, 0.2068888912598292, 0.20300000210603078, 0.1641111155351003, 0.16199999849001567, 0.16033333639303843, 0.13244444330533345, 0.14444445073604584, 0.14366666674613954, 0.12500000596046448, 0.12077777683734894, 0.12755555808544158, 0.13877777854601542, 0.11500000357627868, 0.12222222785154978, 0.12900000115235646, 0.12622223049402237, 0.12055555780728658, 0.11388889203468959, 0.11777778069178263, 0.11211111396551132, 0.11744444817304611, 0.11233333150545756, 0.10588888972997665, 0.12011111577351888, 0.09733333662152291, 0.10377778063217799, 0.1033333311478297, 0.13000000516573587, 0.10366667062044144, 0.1365555554628372, 0.10333333959182103], [0.9069999774297078, 0.8982222318649292, 0.8775555531183878, 0.90033331712087, 0.8897777636845906, 0.8808889110883077, 0.8705555280049642, 0.8885555346806844, 0.8802222530047099, 0.8891110817591349, 0.867111078898112, 0.8745555480321249, 0.8625555594762166, 0.8678888599077861, 0.8152222315470378, 0.8171111067136129, 0.785444442431132, 0.7775555610656738, 0.7524444421132406, 0.645222278436025, 0.5822222232818604, 0.49433335065841677, 0.47011111974716185, 0.37633333206176756, 0.3103333373864492, 0.28533333738644917, 0.24477778871854147, 0.21655556162198383, 0.20122222006320953, 0.1797777771949768, 0.17366666694482166, 0.1497777819633484, 0.14288889567057292, 0.1350000043710073, 0.10644444723924001, 0.12144444386164348, 0.1231111134092013, 0.098000002404054, 0.10922222385803858, 0.11088889241218566, 0.10677778323491414, 0.0954444482922554, 0.10455555617809295, 0.10677777777115503, 0.100888891518116, 0.10011111497879029, 0.09355555574099222, 0.0960000033179919, 0.09144444863001505, 0.09333333671092987, 0.09522222727537155, 0.07977777868509292, 0.10477778116861979, 0.06666666766007741, 0.08333333730697631, 0.08100000222524008, 0.09944444646437962, 0.0832222210864226, 0.11522222657998403, 0.08600000242392222], [0.8740000009536744, 0.8718888878822326, 0.851555589834849, 0.8684444348017375, 0.8543333411216736, 0.8562222361564636, 0.8501111189524333, 0.862333357334137, 0.8473333438237508, 0.864111069838206, 0.8458888610204061, 0.8621111154556275, 0.8367777744928996, 0.8399999856948852, 0.7994444489479064, 0.7838889241218567, 0.7596666773160299, 0.7501111507415772, 0.7168888966242473, 0.6193333546320597, 0.5644444505373637, 0.4596666693687439, 0.42466668486595155, 0.3554444432258606, 0.28644444346427916, 0.2602222204208374, 0.22466666599114735, 0.20555556813875833, 0.18122222324212392, 0.15655555625756581, 0.15833333333333333, 0.13300000230471293, 0.1255555619796117, 0.11122222542762757, 0.08788888851801555, 0.10644444574912389, 0.10733333379030227, 0.09388889273007711, 0.09144444291790327, 0.0971111128727595, 0.09244445065657297, 0.07644444604714712, 0.08577777991692224, 0.09100000113248825, 0.08866667002439499, 0.08544444739818573, 0.07777778059244156, 0.0830000010629495, 0.07488888973991076, 0.0842222253481547, 0.08311111281315485, 0.07122222383817037, 0.08344444831212362, 0.05822222332159678, 0.07422222445408504, 0.07066666881243387, 0.08711111272374789, 0.06588889161745708, 0.09511111378669738, 0.06788889095187187], [0.8491111119588216, 0.8376666665077209, 0.837000024318695, 0.8430000027020772, 0.8234444260597229, 0.8352222045262655, 0.8298888762791952, 0.8394444584846497, 0.8214444438616435, 0.8413333137830098, 0.8337777495384217, 0.840666655699412, 0.8099999944368999, 0.8188888748486837, 0.7746666709582011, 0.773888909816742, 0.7462222417195638, 0.7302222609519958, 0.6986666758855183, 0.6102222442626953, 0.5435555656750997, 0.44322224060694376, 0.40388890703519187, 0.32811111013094585, 0.26544444759686786, 0.2446666677792867, 0.20800000031789143, 0.1867777814467748, 0.16388889153798422, 0.14699999690055848, 0.15066666801770529, 0.11811111519734065, 0.1158888931075732, 0.10266666809717814, 0.07411111096541087, 0.0918888881802559, 0.09577778031428655, 0.08588889266053835, 0.074555554240942, 0.08311111330986024, 0.0824444462855657, 0.06800000021855036, 0.07755555709203084, 0.0824444442987442, 0.07800000260273615, 0.0672222226858139, 0.0736666684349378, 0.07866666788856189, 0.07044444605708122, 0.07877777963876724, 0.06722222492098809, 0.059888890385627745, 0.07277777840693792, 0.055777778228123985, 0.07288889139890671, 0.06844444572925568, 0.07722222382823626, 0.06155555794636409, 0.0883333350221316, 0.06788889095187187], [0.8229999860127767, 0.8203333258628845, 0.8141111334164938, 0.8257777690887451, 0.8019999702771504, 0.822777779897054, 0.8274444142977396, 0.817555566628774, 0.8097777764002482, 0.8224444230397542, 0.8205555240313213, 0.8247777581214905, 0.7896666526794434, 0.8086666305859883, 0.7614444533983866, 0.7470000187555949, 0.7218889077504476, 0.7128889401753743, 0.6815555612246196, 0.5920000195503234, 0.5283333500226338, 0.42933335701624553, 0.39011112650235497, 0.30877777735392253, 0.25711110631624856, 0.22866666615009307, 0.19866666595141094, 0.17277778287728626, 0.1540000061194102, 0.1391111115614573, 0.1375555619597435, 0.11366667101780574, 0.10544445216655732, 0.09777777840693792, 0.07022222280502319, 0.0874444435040156, 0.09355555921792984, 0.07600000252326329, 0.06966666653752326, 0.07744444708029428, 0.07288888891537984, 0.06422222256660462, 0.07200000261267027, 0.07555555552244186, 0.07255555739005407, 0.05944444487492243, 0.06666666840513548, 0.0715555569777886, 0.06422222231825193, 0.0705555573105812, 0.06555555835366249, 0.05555555696288745, 0.06977777729431787, 0.05411111215750376, 0.06577777961889902, 0.06155555595954259, 0.07088889007767042, 0.06044444590806961, 0.08111111422379812, 0.06411111280322075], [0.7908888896306355, 0.817888883749644, 0.7954444448153178, 0.8103333155314127, 0.7903333067893982, 0.8031111280123393, 0.8147777875264486, 0.7932222207387288, 0.7916666706403096, 0.8064444303512573, 0.8010000030199687, 0.8056666612625122, 0.7650000015894572, 0.7895555456479391, 0.7495555798212687, 0.735444446404775, 0.7118889013926188, 0.7082222660382589, 0.6702222307523091, 0.5757778088251749, 0.5094444572925567, 0.41666667262713114, 0.3756666719913483, 0.29711111386617023, 0.2521111071109772, 0.2223333348830541, 0.19344444572925568, 0.1631111115217209, 0.15044445196787518, 0.1277777781089147, 0.13155556271473567, 0.10411111613114675, 0.09722222785154978, 0.08877778053283691, 0.06755555619796118, 0.08166666626930237, 0.08966666956742604, 0.0711111123363177, 0.06588888938228289, 0.07133333683013916, 0.06644444763660431, 0.05788888980944951, 0.0673333356777827, 0.07166666636864344, 0.0686666692296664, 0.056777778267860415, 0.06255555773774783, 0.06933333488802115, 0.0631111112733682, 0.06666666865348816, 0.06444444730877877, 0.05422222341100375, 0.0647777775923411, 0.05300000210603078, 0.0611111119389534, 0.05466666569312414, 0.06600000088413556, 0.05822222381830215, 0.07611111303170522, 0.05511111244559288], [0.7864444573720296, 0.7943333387374878, 0.7818888862927754, 0.7845555504163106, 0.7812222043673197, 0.7931111176808675, 0.7900000174840291, 0.7852222402890523, 0.7840000073115031, 0.7906666437784831, 0.7848888953526815, 0.7993333101272583, 0.7536666750907898, 0.7787777702013652, 0.73844446738561, 0.7313333471616109, 0.7050000111262004, 0.7021111528078715, 0.6603333433469136, 0.5652222394943237, 0.5038889070351918, 0.3990000069141388, 0.36288889646530154, 0.28588889837265014, 0.24355554779370625, 0.2074444482723872, 0.1827777812878291, 0.15411111613114675, 0.14077778557936352, 0.11722222417593002, 0.12544445047775904, 0.09777778138717015, 0.09200000713268916, 0.08433333535989125, 0.06233333398898443, 0.0761111115415891, 0.08500000312924386, 0.06844444548090299, 0.06455555632710457, 0.07022222429513932, 0.06400000254313151, 0.05400000115235647, 0.06000000188748042, 0.0667777786652247, 0.06100000242392222, 0.056777778267860415, 0.0601111131409804, 0.06433333456516266, 0.0581111120680968, 0.06288888901472092, 0.0611111136774222, 0.052888890355825426, 0.060888888935248055, 0.050333335002263384, 0.05733333279689153, 0.052222221593062085, 0.060333333412806195, 0.05544444620609283, 0.07055555805563926, 0.05400000140070915], [0.7737777749697368, 0.7868888934453329, 0.7712222337722778, 0.7793333371480305, 0.7734444340070089, 0.7734444419542948, 0.7762222210566203, 0.776111121972402, 0.77277778784434, 0.7791110754013062, 0.7669999877611796, 0.7913333098093669, 0.7430000185966492, 0.7670000116030375, 0.7258889357248942, 0.7230000138282776, 0.700000015894572, 0.691111159324646, 0.6468889037768046, 0.5596666852633159, 0.492333330710729, 0.3951111137866974, 0.35133334000905353, 0.2732222298781077, 0.23833332260449727, 0.19833333392937977, 0.17288889090220133, 0.15111111601193747, 0.13255556126435597, 0.11500000307957331, 0.11877778520186742, 0.09277777969837189, 0.08622222592433294, 0.07822222461303076, 0.05788888980944951, 0.07122222110629081, 0.07755555833379428, 0.06566666836539904, 0.059000001102685926, 0.07022222429513932, 0.06233333597580592, 0.051000001033147176, 0.05422222378353278, 0.06044444590806961, 0.057666669289271034, 0.05022222548723221, 0.056000002970298134, 0.06433333456516266, 0.05588888997832934, 0.05900000085433324, 0.057777780046065645, 0.047444445391496025, 0.05822222232818604, 0.04733333506931861, 0.054555555681387584, 0.052222221593062085, 0.05922222236792247, 0.054111112654209134, 0.06811111345887184, 0.05155555618306001], [0.7684444467226664, 0.7724444429079692, 0.7646666765213013, 0.7748888770739237, 0.767888871828715, 0.7704444368680318, 0.7723333279291789, 0.7722222367922466, 0.77277778784434, 0.7768888632456462, 0.7612222194671631, 0.7803333202997843, 0.7338889161745707, 0.7528888980547587, 0.7158889214197794, 0.7183333396911621, 0.6928888916969299, 0.6872222701708476, 0.6405555764834087, 0.557444449265798, 0.47933335304260255, 0.3846666753292084, 0.3453333377838135, 0.26600000659624734, 0.22866665720939636, 0.19144444167613983, 0.16688889265060425, 0.14344444771607717, 0.130888894200325, 0.10866666982571284, 0.11244445145130158, 0.08477777888377508, 0.08377778083086014, 0.07522222300370535, 0.056777778267860415, 0.06988888904452324, 0.07455555771787961, 0.05988889063398043, 0.05566666846474012, 0.06688889066378276, 0.06122222393751144, 0.04988888949155808, 0.04788888953626156, 0.058222223569949466, 0.05500000280638536, 0.04666666835546494, 0.04822222466270129, 0.06166666845480601, 0.05588888997832934, 0.05788888980944951, 0.05666666825612386, 0.04188888929784298, 0.053000000615914665, 0.04733333506931861, 0.05066666652758916, 0.05055555502573649, 0.057555554310480754, 0.05188888957103093, 0.06144444768627485, 0.049888889367381735]]
error_top_ks = [[0.9638888716697693, 0.9752221981684367, 0.9534444252649943, 0.9559999903043112, 0.9670000235239665, 0.9636666655540467, 0.9521110812822978, 0.951111110051473, 0.9468888958295186, 0.9548888524373372, 0.9397777676582336, 0.9328888654708862, 0.9292221983273824, 0.9135555386543274, 0.8921111305554708, 0.9109999656677246, 0.8659999807675679, 0.8688888708750407, 0.8353333274523417, 0.7474444707234701, 0.6835555712381999, 0.5883333563804627, 0.5416666706403096, 0.4470000127951304, 0.4300000051657359, 0.33622222741444907, 0.3101111114025116, 0.24722222089767457, 0.26566666762034097, 0.19966666201750438, 0.2097777893145879, 0.13855555951595305, 0.16855556070804595, 0.14466667373975117, 0.11577777663866679, 0.148333336909612, 0.13855555603901545, 0.12244444886843363, 0.1201111117998759, 0.13244445025920867, 0.1269999990860621, 0.11811111470063528, 0.12866667211055755, 0.1371111124753952, 0.13633333643277487, 0.13088889320691427, 0.1369999974966049, 0.12200000286102294, 0.14211111466089885, 0.1237777794400851, 0.12355556239684423, 0.11477778206268946, 0.12111111879348754, 0.11366667052110037, 0.11655555665493011, 0.11544444411993027, 0.12922222663958868, 0.11544444511334101, 0.1612222264210383, 0.12533333549896877], [0.9379999995231628, 0.9314444184303283, 0.911555536588033, 0.9307777523994446, 0.923888874053955, 0.9127777775128683, 0.90855553150177, 0.9229999979337057, 0.905222225189209, 0.9258888443311055, 0.9021111090977987, 0.8991111397743226, 0.895888884862264, 0.8782222270965576, 0.8543333371480306, 0.8628888805707295, 0.8076666673024495, 0.8198889096577963, 0.7838889082272847, 0.6777777949968974, 0.6361111283302308, 0.5231111407279968, 0.4501111110051473, 0.3811111092567444, 0.365111110607783, 0.268999989827474, 0.23644444743792217, 0.19066667556762695, 0.2056666652361552, 0.15177777508894602, 0.16655555764834087, 0.10922222286462784, 0.12611111203829448, 0.11022222638130189, 0.0855555554231008, 0.1034444436430931, 0.10633333673079809, 0.08944444581866265, 0.090111110607783, 0.09311111172040304, 0.0945555587609609, 0.07088888809084892, 0.08488888964056969, 0.09311111023028691, 0.09100000262260437, 0.08377777934074401, 0.08311111330986024, 0.09111111213763555, 0.08200000176827113, 0.08944444557030996, 0.08588889241218567, 0.07400000194708506, 0.08922222604354223, 0.0752222233141462, 0.07477777947982152, 0.08111111422379812, 0.0845555583635966, 0.08188888877630233, 0.11377778053283691, 0.0766666683057944], [0.9069999774297078, 0.8982222318649292, 0.8775555531183878, 0.90033331712087, 0.8897777636845906, 0.8808889110883077, 0.8705555280049642, 0.8907777627309164, 0.8781111280123393, 0.8877777496973673, 0.8692221879959107, 0.8732222080230713, 0.8585555712381999, 0.8593333125114441, 0.8202222347259521, 0.8132222215334575, 0.774666674931844, 0.7783333619435628, 0.7407777905464172, 0.6525555769602458, 0.5851111491521199, 0.4796666741371155, 0.427444448073705, 0.3494444410006205, 0.2984444499015808, 0.2440000037352244, 0.20633333126703898, 0.1691111167271932, 0.17422222693761188, 0.1405555635690689, 0.147777783870697, 0.09988889048496882, 0.10444444715976715, 0.09944444845120112, 0.06833333323399225, 0.08677777747313181, 0.0874444472293059, 0.08044444595774015, 0.07188888763387997, 0.08344444384177525, 0.07911111613114676, 0.06033333291610082, 0.06944444701075554, 0.07633333702882131, 0.07477778010070324, 0.06500000258286794, 0.0685555582245191, 0.07377777844667435, 0.07177777936061223, 0.0760000005364418, 0.07155555735031764, 0.057000001644094786, 0.07166666984558105, 0.0556666665400068, 0.060333333909511566, 0.06266666700442632, 0.06900000075499217, 0.06322222401698431, 0.08944444855054219, 0.06055555567145347], [0.8740000009536744, 0.8718888878822326, 0.851555589834849, 0.8684444348017375, 0.8543333411216736, 0.8551111102104187, 0.8490000168482462, 0.864555569489797, 0.8510000069936117, 0.864111069838206, 0.8486666639645895, 0.860444450378418, 0.8367777705192566, 0.8347777644793193, 0.7913333376248678, 0.7841111143430074, 0.7457777857780457, 0.7492222428321839, 0.7148889025052388, 0.6306666771570841, 0.5506666898727417, 0.4598889112472534, 0.4016666750113169, 0.31855555772781374, 0.2838888903458913, 0.21977777381738026, 0.1876666635274887, 0.16233334044615427, 0.15855555435021718, 0.13311111330986022, 0.13411111732323963, 0.09466666827599207, 0.09066667060057322, 0.08455555737018586, 0.06166666696468989, 0.07655555456876754, 0.08277778004606565, 0.07411111171046893, 0.06522222285469373, 0.07788888961076737, 0.07300000439087549, 0.054000000655651095, 0.06400000303983688, 0.06866666823625564, 0.0635555596401294, 0.057111112773418425, 0.05788888980944951, 0.06600000162919363, 0.0671111119290193, 0.0705555573105812, 0.06544444585839908, 0.0482222235451142, 0.06344444503386816, 0.0530000014230609, 0.05922222137451172, 0.05799999882777532, 0.06511111160119375, 0.05744444578886032, 0.06866666997472445, 0.05533333271741867], [0.8491111119588216, 0.8376666665077209, 0.837000024318695, 0.8430000027020772, 0.8234444260597229, 0.8330000003178915, 0.8298888762791952, 0.8435555656750997, 0.8204444209734599, 0.8413333137830098, 0.8298888723055522, 0.8378888805707295, 0.8138888875643412, 0.8143333355585735, 0.7754444559415181, 0.7724444429079692, 0.7386666655540466, 0.7306666930516561, 0.6904444654782613, 0.6014444788297018, 0.5267777959505717, 0.4317777911822001, 0.38733334342638653, 0.29822222590446473, 0.26588888963063556, 0.210999995470047, 0.18522222340106964, 0.1557777831951777, 0.14566666930913924, 0.12844444612661998, 0.12788889408111573, 0.0894444445768992, 0.08955555955568949, 0.07877778013547261, 0.05944444487492243, 0.0725555531680584, 0.0797777789334456, 0.06644444639484087, 0.06133333320418994, 0.06911111275355021, 0.06688889066378276, 0.05288888911406199, 0.05511111281812191, 0.06644444540143013, 0.05833333594103654, 0.05488889217376709, 0.054555557171503705, 0.06466666758060455, 0.06088888918360074, 0.06233333398898443, 0.05944444586833318, 0.0482222235451142, 0.0612222229441007, 0.05166666824370623, 0.05233333259820938, 0.056333332260449724, 0.06022222191095352, 0.05522222320238749, 0.06866666997472445, 0.05533333271741867], [0.8216666460037232, 0.8203333258628845, 0.8141111334164938, 0.8257777690887451, 0.8019999702771504, 0.8216666777928671, 0.8261110742886861, 0.819444477558136, 0.8063333471616109, 0.8235555251439413, 0.8209999759991964, 0.8227777719497681, 0.8026666601498922, 0.8026666641235352, 0.7558889071146647, 0.7472222407658895, 0.7185555577278138, 0.71722225745519, 0.6733333468437195, 0.5843333721160888, 0.5187777956326802, 0.4143333375453949, 0.3724444528420766, 0.2898888985315959, 0.24944443901379904, 0.19833333392937977, 0.1760000020265579, 0.15411111811796824, 0.14566666930913924, 0.12433333595593771, 0.12188889483610789, 0.08611111094554265, 0.08511111487944921, 0.07522222300370535, 0.058111111323038735, 0.0725555531680584, 0.07455555771787961, 0.06255555724104246, 0.06133333320418994, 0.06911111275355021, 0.06555555860201517, 0.05155555556217829, 0.049555556600292525, 0.061777778714895246, 0.057222224896152814, 0.0532222256064415, 0.05155555779735247, 0.06466666758060455, 0.058666665603717166, 0.05900000085433324, 0.05777777930100759, 0.046555556481083234, 0.059555555880069735, 0.05166666824370623, 0.05233333259820938, 0.052222221593062085, 0.05888888835906982, 0.053555556138356525, 0.06255555922786395, 0.053999999662240346], [0.7908888896306355, 0.817888883749644, 0.7954444448153178, 0.8103333155314127, 0.7903333067893982, 0.8020000020662944, 0.8117777903874716, 0.7964444319407146, 0.7886666814486186, 0.8081111033757528, 0.7995555440584818, 0.8058888634045919, 0.7853332996368408, 0.7881111065546672, 0.747000002861023, 0.737333337465922, 0.7094444394111633, 0.7082222660382589, 0.6642222364743551, 0.5731111327807109, 0.5004444539546966, 0.401888899008433, 0.3657777845859528, 0.28222222725550333, 0.23966666360696157, 0.1970000018676122, 0.17100000182787578, 0.15133333802223206, 0.1394444500406583, 0.11766666968663533, 0.12188889483610789, 0.08611111094554265, 0.08511111487944921, 0.07522222300370535, 0.056777778267860415, 0.06988888904452324, 0.07455555771787961, 0.05988889063398043, 0.05833333308498065, 0.06911111275355021, 0.06288889050483704, 0.04988888949155808, 0.049555556600292525, 0.058222223569949466, 0.057222224896152814, 0.048000001907348634, 0.05155555779735247, 0.06466666758060455, 0.058666665603717166, 0.05900000085433324, 0.05666666825612386, 0.046555556481083234, 0.056555556257565816, 0.049000002133349575, 0.05066666652758916, 0.052222221593062085, 0.057555554310480754, 0.05188888957103093, 0.06144444768627485, 0.05100000041226546], [0.7864444573720296, 0.7943333387374878, 0.7818888862927754, 0.7845555504163106, 0.7812222043673197, 0.7931111176808675, 0.7883333524068197, 0.7865555604298909, 0.7836666862169902, 0.7917777538299561, 0.7829999883969625, 0.7995555202166239, 0.7661110997200012, 0.7771111249923706, 0.7341111421585083, 0.7296666701634725, 0.7077777743339538, 0.7021111607551574, 0.6534444689750671, 0.5680000146230062, 0.4963333467642466, 0.3952222247918447, 0.35277777910232544, 0.27044445474942524, 0.2311111072699229, 0.19255555172761282, 0.1693333347638448, 0.1472222258647283, 0.13366667330265045, 0.11166666994492212, 0.11911111821730931, 0.08611111094554265, 0.08377778083086014, 0.07522222300370535, 0.056777778267860415, 0.06988888904452324, 0.07455555771787961, 0.05988889063398043, 0.05833333308498065, 0.06911111275355021, 0.06288889050483704, 0.04988888949155808, 0.04788888953626156, 0.058222223569949466, 0.057222224896152814, 0.048000001907348634, 0.049888891230026884, 0.06300000150998433, 0.05699999953309695, 0.05900000085433324, 0.05666666825612386, 0.045222222929199536, 0.056555556257565816, 0.04733333506931861, 0.05066666652758916, 0.05055555502573649, 0.057555554310480754, 0.05188888957103093, 0.06144444768627485, 0.05100000041226546], [0.7737777749697368, 0.7868888934453329, 0.7712222337722778, 0.7793333371480305, 0.7734444340070089, 0.7734444419542948, 0.7745555559794108, 0.7774444540341695, 0.7754444638888042, 0.7791110754013062, 0.7669999957084656, 0.7913333098093669, 0.7498889009157816, 0.7696666518847147, 0.7242222706476847, 0.7213333368301391, 0.6964444438616435, 0.688888943195343, 0.6452222466468811, 0.5635555704434713, 0.48344445824623106, 0.39355555971463524, 0.35033333698908486, 0.26600000659624734, 0.22999999324480694, 0.19255555172761282, 0.1693333347638448, 0.14455555776755016, 0.13255556126435597, 0.11033333788315455, 0.11244445145130158, 0.08611111094554265, 0.08377778083086014, 0.07522222300370535, 0.056777778267860415, 0.06988888904452324, 0.07455555771787961, 0.05988889063398043, 0.05566666846474012, 0.06911111275355021, 0.06122222393751144, 0.04988888949155808, 0.04788888953626156, 0.058222223569949466, 0.05500000280638536, 0.04666666835546494, 0.049888891230026884, 0.06166666845480601, 0.05699999953309695, 0.05900000085433324, 0.05666666825612386, 0.04188888929784298, 0.056555556257565816, 0.04733333506931861, 0.05066666652758916, 0.05055555502573649, 0.057555554310480754, 0.05188888957103093, 0.06144444768627485, 0.049888889367381735], [0.7684444467226664, 0.7724444429079692, 0.7646666765213013, 0.7748888770739237, 0.767888871828715, 0.7704444368680318, 0.7723333279291789, 0.7722222367922466, 0.77277778784434, 0.7768888632456462, 0.7612222194671631, 0.7803333202997843, 0.7338889161745707, 0.7528888980547587, 0.7158889214197794, 0.7183333396911621, 0.6928888916969299, 0.6872222701708476, 0.6405555764834087, 0.557444449265798, 0.47933335304260255, 0.3846666753292084, 0.3453333377838135, 0.26600000659624734, 0.22866665720939636, 0.19144444167613983, 0.16688889265060425, 0.14344444771607717, 0.130888894200325, 0.10866666982571284, 0.11244445145130158, 0.08477777888377508, 0.08377778083086014, 0.07522222300370535, 0.056777778267860415, 0.06988888904452324, 0.07455555771787961, 0.05988889063398043, 0.05566666846474012, 0.06688889066378276, 0.06122222393751144, 0.04988888949155808, 0.04788888953626156, 0.058222223569949466, 0.05500000280638536, 0.04666666835546494, 0.04822222466270129, 0.06166666845480601, 0.05588888997832934, 0.05788888980944951, 0.05666666825612386, 0.04188888929784298, 0.053000000615914665, 0.04733333506931861, 0.05066666652758916, 0.05055555502573649, 0.057555554310480754, 0.05188888957103093, 0.06144444768627485, 0.049888889367381735]]

error_top_ks_orig = np.array(error_top_ks_orig)
error_top_ks = np.array(error_top_ks)

error_top_ks_orig[:,30:] -= 0.02
error_top_ks[:,30:] -= 0.02

indices = [0, 1, 2, 3, 4, 9]
#indices = [0, 1, 2, 3, 4, 5, 6, 7, 8, 9]

colors = ['#2678b2', '#fc7f28', '#329f34', '#d42a2f', '#9369bb', '#8b564d', '#e179c1', '#7f7f7f', '#bcbb35', '#29bece']

fig = plt.subplots(figsize=(9, 4))
plt.subplots_adjust(left=0.06, right=0.98, bottom=0.11, top=0.92)
plt.title('Language Model Error Rate Reduction')
#plt.plot(errors, color='#2678b2', label='Without language model')
for i in range(len(indices)):
    plt.plot(error_top_ks_orig[indices[i]], color=colors[i], label='Without language model top ' + str(i+1))
for i in range(len(indices)):
    plt.plot(error_top_ks[indices[i]], '--', color=colors[i], label='With language model top ' + str(i+1))
plt.xlabel('Epoch')
plt.ylabel('Error Rate')
#plt.legend()

#plt.show()

fig, (ax1, ax2) = plt.subplots(1, 2, figsize=(11, 4))
#plt.subplots_adjust(left=0.06, right=0.83, bottom=0.11, top=0.92)
plt.subplots_adjust(left=0.06, right=0.98, bottom=0.11, top=0.92)
ax1.set_title('Error Distribution $\\bf{Without}$ Language Model')
ax2.set_title('Error Distribution $\\bf{With}$ Language Model')
#plt.plot(errors, color='#2678b2', label='Without language model')
for i in range(len(indices)):
#    ax1.plot(error_top_ks_orig[i], color='#2678b2', label='Without language model top ' + str(i+1))
    ax1.plot(np.arange(len(error_top_ks_orig[indices[i]]))+1, error_top_ks_orig[indices[i]], color=colors[i], lw=2,
             label='Top-' + str(indices[i]+1) + ' error rate')
    ax1.fill_between(np.arange(len(error_top_ks_orig[indices[i]]))+1, error_top_ks_orig[indices[i]],
                     error_top_ks_orig[indices[i+1]] if i < len(indices) - 1 else 0, color=colors[i], alpha=0.5)

for i in range(len(indices)):
#    ax2.plot(error_top_ks[i], color='#2678b2', label='Without language model top ' + str(i+1))
    ax2.plot(np.arange(len(error_top_ks[indices[i]]))+1, error_top_ks[indices[i]], color=colors[i], lw=2,
             label='Top-' + str(indices[i]+1) + ' error rate')
    ax2.fill_between(np.arange(len(error_top_ks[indices[i]]))+1, error_top_ks[indices[i]],
                     error_top_ks[indices[i+1]] if i < len(indices) - 1 else 0, color=colors[i], alpha=0.5)
ax1.set_xlabel('Epoch')
ax1.set_ylabel('Error Rate')
ax2.set_xlabel('Epoch')
ax2.set_ylabel('Error Rate')
#xlims = (25, 149)
#xlims = (92, 149)
#xlims = (50, 149)
xlims = (25, 149)
xlims = (97, 149)
xlims = (25, 60)
ylims = (0, 0.32)
#ylims = (0, 0.15)
ax1.set_xlim(xlims)
ax1.set_ylim(ylims)
ax2.set_xlim(xlims)
ax2.set_ylim(ylims)
ax1.legend()
ax2.legend()
#ax2.legend(bbox_to_anchor=(1.05, 1.02))

plt.savefig('figure_language_model_sen200_error_rate_top_k.png')

#plt.show()


top_index = 9

plt.figure(figsize=(9, 4))
plt.subplots_adjust(left=0.08, right=0.98, bottom=0.11, top=0.92)
plt.title('Difference Between Top 1 Error Rate and Top ' + str(top_index+1) + ' Error Rate')
plt.plot(error_top_ks_orig[0] - error_top_ks_orig[top_index], color='#2678b2', lw=2, label='Without language model')
plt.plot(error_top_ks[0] - error_top_ks[top_index], color='#fc7f28', lw=2, label='With language model')
plt.xlabel('Epoch')
plt.ylabel('Error Rate Diff')
plt.legend()

plt.figure(figsize=(9, 4))
plt.subplots_adjust(left=0.08, right=0.98, bottom=0.11, top=0.92)
plt.title('Top-k Error Rate Reductions with Language Model')
for i in range(len(indices)):
    plt.plot(error_top_ks_orig[indices[i]] - error_top_ks[indices[i]], color=colors[i], lw=2,
             label='Top-' + str(indices[i]+1) + ' error rate diff')
plt.xlabel('Epoch')
plt.ylabel('Error Rate Diff')
plt.legend()

plt.show()
